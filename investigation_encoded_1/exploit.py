from pwn import *

kamus = {}

with open("kamus.txt") as kamus_output:
    for baris in kamus_output:
        baris = baris.rstrip("\n")
        char = baris.split(": ")[0]
        biner_char = baris.split(": ")[1]

        kamus[biner_char] = char

with open("output", "rb") as output:
    data = output.read()
    bin_data = bits_str(data);
    log.info("Data biner:\n{}".format(bin_data))
    
    hasil = ""

    while bin_data:
        for k in kamus:
            if bin_data.startswith(k):
                hasil += kamus[k]
                bin_data = bin_data[len(k):]

log.success("Flag: {}".format(hasil))
